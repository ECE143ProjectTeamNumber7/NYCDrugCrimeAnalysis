# NYCDrugCrimeAnalysis

### File Structure
```
+-- data
|   +-- Drug_Crime_20231111.csv
|   +-- 2020_Census
|   |   +-- dcp-comps-of-chg-StoryMap-data-032023-Total-Population-Asian.csv
|   |   +-- dcp-comps-of-chg-StoryMap-data-032023-Total-Population-Black.csv
|   |   +-- dcp-comps-of-chg-StoryMap-data-032023-Total-Population-Hispanic.csv
|   |   +-- dcp-comps-of-chg-StoryMap-data-032023-Total-Population-White.csv
|   |   +-- dcp-comps-of-chg-StoryMap-data-032023-Total-Population.csv
|   +-- City_Features
|   |   +-- Borough_Boundaries.geojson
|   |   +-- Community_Districts.geojson
|   +-- Housing_Prices
|   |   +-- 2015_bronx.xls
|   |   +-- 2015_brooklyn.xls
|   |   +-- 2015_manhattan.xls
|   |   +-- 2015_queens.xls
|   |   +-- 2015_statenisland.xls
|   +-- Race Pie Chart
|   +-- Population_by_District.xlsx
+-- data_utils.py
+-- preprocess_utils.py
+-- NYC_Drug_Crime_Visualizations.ipynb
```
* `data` stores all datasets for analysis.
    * `Drug_Crime_20231111.csv` is the primary dataset that stores all NYC drug crime data points.
    * `2020_Census` stores all NYC Census data (manually reformatted and split by race).
    * `City_Features` stores all NYC district and borough `geojson` format datasets for geographical analysis via Folium.
    * `Housing_Prices` stores all NYC housing prices datasets by borough.
    * `Race Pie Chart` stores all generated Pie Charts generated by the Visualization Notebook. This is technically a runtime directory, but data is kept for individual analysis of the racial compositions outside of the notebook.
    * `Population_by_District.xlsx` is a secondary dataset (manually reformatted) similar to `2020_Census` with additional `GeoID` information.
* `data_utils.py` contains supplementary minimally specific functions to quick access and perform certain dataset related functionalities. Many functions expect the data provided to be preprocessed.
* `preprocess_utils.py` contains all preprocessing functions used to preprocess the primary datasets (`Drug_Crime` and `2020_Census`).

### Modules
**Files**
* [os](https://docs.python.org/3/library/os.html)
* [glob](https://docs.python.org/3/library/glob.html)
* [json]()

**Data Manipulation**
* [pandas](https://pandas.pydata.org/docs/reference/index.html)
* [numpy](https://numpy.org/doc/stable/reference/index.html#reference)
* [statistics]()

**Visualization**
* [matplotlib]()
* [plotly]()
* [seaborn]()
* [folium]()
* [shapely]()

### How To Use
1. **Install Necessary Modules**
The modules listed above are used to run the visualizations. Installing [Anaconda](https://www.anaconda.com/) is suggested; however, only the ones listed above are required at minimum and can be installed with `pip`. Note that some modules, such as *folium* or *shapely*, may not be included with anaconda and will require seperate installation with `pip`. In the Notebook, some functions require dependencies that may not be included in Anaconda and may vary across machines; thus, it is vital you pay careful attention to possible errors raised by missing dependencies. Having the same version is crucial; some visualizations utlize features from more recent versioins.
2. **Running Code**
    - *Visualizations Only:* Open the notebook in `VSCode` or via `jupyter notebook` in a terminal with anaconda. Press `>> Run all` to run all visualization code.
    - *Importing and **Quick** Preprocessing:*
        * In this case, quick preprocessing does not mean it is fast at its job, but rather preprocessing is done at the "press of a button". The datasets are large, so preprocessing takes some time.
        > ```Python
        > import data_utils as du
        > 
        > #### Step 1: Read in the raw dataset. 
        > # import_csv_data() will return a dict with the filename as the key and the dataset as a pd.DataFrame as the value.
        > # Leaving it blank like below will import all relevant datasets (Drug_Crime and 2020_Census/) and also rename them to a simplified form. 
        > # Note: If you have other .csv datasets, their keys *will not* be renamed.
        > # This line will store {'Drug_Crme': {...}, 'All': {...}, 'Asian': {...}, 'White': {...}, ...}
        > # Indices are: ['All', 'Asian', 'Black', 'Hispanic', 'White']
        > raw_datasets = du.import_csv_data()
        >
        > #### Step 2: Preprocess the raw dataset.
        > # preprocess_datasets() will automatically perform all preprocessing on the primary datasets (Drug_Crime, 2020_Census).
        > # The dict with each of the datasets should must be provded for any preprocessing to occur. 
        > # However, the dict is not required to be filled or complete with all the raw_datasets; although, it is better to do so in order to preprocess all at once.
        > # Only datasets in the dict with keys belong in ['Drug_Crime', 'All', 'Asian', 'Black', 'Hispanic', 'White'] will be preprocessed.
        > # Moreover, the provided census datasets will be merged into one dataset.
        > # This line will store {'Drug_Crime': {...}, 'Census': {...}}
        > # Indices are: ['Drug_Crime', 'Census']
        > datasets = pu.preprocess_datasets(raw_datasets)
        > ```
    - *Manual Preprocessing:*

3. **Data Manipulation**
Data manipulation is expected to be manual, but some semi-generalized functions are provided to help simplify the process.


### Proposal
As you are aware, drug-related crimes have been a persistent issue in urban areas, including New York City. Understanding the dynamics and patterns of these crimes can have significant implications for law enforcement and policymakers. Research in this field can provide insights into the underlying factors of drug-related crimes in NYC.

Our project proposal aims to explore the trends and patterns in drug crimes in NYC using available data that includes the precincts where these crimes occurred, the specific time of when they occured, when the crime was reported, descriptions and levels of offense, whether the crime was successfully completed, latitude-longitude coordinates, and more.

Also, we will investigate the correlation between the crimes and other factors, like geography, population, race, and compare the difference between districts. We aim to identify geographical hotspots and coldspots of drug-related crimes within NYC, using provided data that includes lat-lon coordinates. We will examine temporal patterns to understand when drug-related crimes are more likely to occur during the day, which can shed light on potential contributing factors. We intend to categorize drug-related offenses by type and severity, offering a deeper understanding of the nature of these crimes in the city.

Our project will involve data cleaning and preprocessing to ensure data quality and accuracy. Multiple columns/features in the dataset have NaNs or ambiguous values (precinct #), and we will deal with this appropriately. We will use various data analysis techniques, including spatial analysis, time series analysis, and data visualization, to achieve the projectâ€™s objectives.

### Relevant Datasets/Data
Drug Crime | NYC Open Data (cityofnewyork.us)
BYTES of the BIG APPLE - DCP (nyc.gov)
2020 Census -DCP (nyc.gov)

#### Plan
| Task | Estimated Time | People Involved |
| ---- | ---- | ---- |
| Extracting Data and Merging Into 1 Dataset | 1.5 weeks | Stephen Dong, Ali Hussain, Kavinder Kanthen, Kai Lu. |
| Cleaning/Preprocessing | 1.5 weeks | Ali Hussain, Kai Lu, Bill (Xuehai Yan) |
| Data Visualization | 1 week | Kavinder Kanthen, Bill (Xuehai Yan), Stephen Dong |